{% extends "master.html" %}

{% block title %}List of Trees - PhyloCommons{% endblock %}

{% block leftmenu %}
{% include "tree_menu.html" %}
{% endblock %}

{% block nav-trees %}class="active"{% endblock %}

{% block content %}

{% if form %}

<form action="{% url tree_list %}" method="post" enctype="multipart/form-data" class="form-inline form-search">
    {% csrf_token %}

    <div class='input-append'>
        {{ form.taxa }}
        {{ form.filter }}
        <button class="btn" type="submit">Search</button>
    </div>

    {{ form.non_field_errors }}
</form>
{% endif %}

{% if tree_list %}
<table class='table table-condensed table-striped table-hover table-bordered'>
    {% for tree_id, count in tree_list %}
    <tr{% if '_taxonomy' in tree_id %} class="success"{% elif count == max_match_count %} class="info"{% elif max_match_count %} class="warning"{% endif %}><td>
        <a href='/trees/{{tree_id}}'>{{tree_id}}</a>{% if max_match_count %} (matched {{ count }}/{{max_match_count}}){% endif %}
    {% if form.taxa.value %}
    <a href='/query/?taxa={{form.taxa.value}}&tree_id={{tree_id}}&taxonomy={{taxonomy}}' class='btn pull-right btn-{% if '_taxonomy' in tree_id %}success{% elif count == max_match_count %}primary{% else %}warning{% endif %}'>Query</a>
    {% endif %}
    <a href='/trees/{{tree_id}}' class='btn pull-right'>Details</a>
    </td></tr>
    {% endfor %}
</table>

<div class="pagination">
    <p>Results <strong>{{low_result}}-{{high_result}}</strong> of <strong>{{total_results}}</strong>.</p>
    <ul>
        {% for page, link in pages %}

        <li{% if page == tree_list.number %} class="active"{% endif %}>
            <a{% if link and page != tree_list.number %} href="{{link}}"{% endif %}>{{ page }}</a>
        </li>

        {% endfor %}
    </ul>
</div>

{% else %}

<p>No trees were found. Try a different search.</p>

{% endif %}

{% endblock %}
